{% extends 'main.html' %}

{% block title %}Dashboard | SloopStash CRM{% endblock %}

{% block content %}
<div class="row">
  <div class="col s3 m3 l3">
    <ul class="tab z-depth-1" id="main-menu">
      <li class="tab-item">
        <a class="tab-link" href="#contacts">
          <span class="fa-stack purple-text text-purple">
            <i class="fa-regular fa-square fa-stack-2x"></i>
            <i class="fa-regular fa-address-book fa-stack-1x"></i>
          </span>
        </a>
        <p><small>Contacts</small></p>
      </li>
    </ul>
  </div>
  <div class="col s18 m18 l18">
    <div class="block tab-content" id="contacts">
      <div class="block-header clearfix valign-wrapper">
        <div class="block-title left">
          <h2>
            <span class="fa-stack purple-text text-purple fa-xs">
              <i class="fa-regular fa-square fa-stack-2x"></i>
              <i class="fa-regular fa-address-book fa-stack-1x"></i>
            </span> Contacts for {{ var.customer.name }}
          </h2>
        </div>
        <div class="block-menu right">
          <a class="btn-small green darken-1 right" href="/customer/{{ var.customer.id }}/contact/create">Create contact</a>
        </div>
      </div>      <div class="block-content">
        <!-- Contact List Table from list.html -->
        <div id="contacts-list">
         <table class="highlight responsive-table">
           <thead>
             <tr>
               <th>FirstName</th>
               <th>LastName</th>
               <th>Email</th>
               <th>Phonenumber</th>
               <th>Description</th>
               <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            {% for contact in var.contacts %}
            <tr>
              <td>{{ contact.firstname }}</td>
              <td>{{ contact.lastname }}</td>
              <td>{{ contact.email }}</td>
              <td>{{ contact.phonenumber }}</td>
              <td>{{ contact.description }}</td>
              <td>
                <div class="action-buttons">
                  <a href="/customer/{{ var.customer.id }}/contact/{{ contact.id }}/update" class="edit-button">
                    <i class="fa-solid fa-pen-clip icon"></i>
                  </a>
                  <form action="/customer/{{ var.customer.id }}/contact/{{ contact.id }}/delete" method="POST" style="display: inline;">
                    <input type="hidden" name="_method" value="DELETE">
                    <button type="submit" class="delete-button" style="color: red; background-color: transparent; border: none; cursor: pointer;"><i class="fa-solid fa-trash-can icon" style="color: red; font-size: 18px;"></i></button>
                  </form>
                </div>
              </td>
            </tr>
            {% else %}
            <tr>
              <td colspan="5" class="center">No contacts found for this customer.</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
    <div class="block-footer">
      <div class="block-action right"></div>
       </div>
     </div>
   </div>
  <div class="col s3 m3 l3"></div>
</div>
{% endblock %}

{% block js %}
<script type="text/javascript">
  $(document).ready(function() {
    var main_menu = new app.tab({
      'container':'#main-menu',
      'default':'contacts',
      'items':[
        {
          'identifier':'#contacts',
          'pager':{
            'name':'contacts',
            'mode':'normal',
            'entity':'contact',
            'url':'/customer/{{ var.customer.id }}/dashboard',
            'query':null,
            'container':'#contacts-list'
          }
        }
      ]
    });
  });
</script>
{% endblock %}
